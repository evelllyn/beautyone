"use strict";(self["webpackChunkvueworks"]=self["webpackChunkvueworks"]||[]).push([[880],{2880:function(t,s,a){a.r(s),a.d(s,{default:function(){return K}});var o=a(3396),e=a(7139),i=a(9242);const n={class:"container fill-in"},l={class:"row cart"},c={key:0},d=(0,o._)("h3",null,"購物清單",-1),u={class:"table align-middle"},r=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{class:"col-1"},"圖片"),(0,o._)("th",{class:"col-5"},"商品名稱"),(0,o._)("th",{class:"col-2"},"數量"),(0,o._)("th",null,"單價"),(0,o._)("th")])],-1),h={class:"input-group input-group-sm"},p=["disabled","onUpdate:modelValue","onChange"],g={class:"input-group-text"},_={key:0},m={key:1,class:"text-danger"},v={class:"text-end"},b=["disabled","onClick"],y=(0,o._)("i",{class:"bi bi-trash3"},null,-1),k=[y],w=(0,o._)("td",{colspan:"4",class:"text-end"},"總計",-1),C={class:"text-end"},f={key:0},$=(0,o._)("td",{colspan:"4",class:"text-end text-danger"},"折扣價",-1),x={class:"text-end text-danger"},L={class:"use-coupon input-group input-group-sm mb-3"},I=(0,o._)("div",{class:"col-7"},null,-1),D={class:"input-group-append"},q={class:"go-pay text-end"},U={key:1,class:"container spin"},z=(0,o._)("div",{class:"spinner-border text-success",role:"status"},[(0,o._)("span",{class:"visually-hidden"},"Loading...")],-1),M=[z],P={key:2,class:"nothing"},S=(0,o._)("i",{class:"bi bi-cart-dash"},null,-1),V=(0,o._)("div",{class:"nothing-content fs-3"},"哎呀，購物車目前是空的喔",-1);function W(t,s,a,y,z,W){const j=(0,o.up)("LoaDing"),H=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(j,{avtive:z.isLoading},null,8,["avtive"]),(0,o._)("div",n,[(0,o._)("div",l,[z.cart.carts.length?((0,o.wg)(),(0,o.iD)("div",c,[d,(0,o._)("table",u,[r,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(z.cart.carts,(s=>((0,o.wg)(),(0,o.iD)("tr",{key:s.id},[(0,o._)("td",{class:"list-pic",style:(0,e.j5)({backgroundImage:`url(${s.product.imageUrl})`})},null,4),(0,o._)("td",null,(0,e.zw)(s.product.title),1),(0,o._)("td",null,[(0,o._)("div",h,[(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",min:"1",disabled:z.status.loadingItem===s.id,"onUpdate:modelValue":t=>s.qty=t,onChange:t=>W.updateCart(s)},null,40,p),[[i.nr,s.qty,void 0,{number:!0}]]),(0,o._)("div",g,(0,e.zw)(s.product.unit),1)])]),(0,o._)("td",null,[z.cart.final_total!==z.cart.total?((0,o.wg)(),(0,o.iD)("small",_,"折扣價")):(0,o.kq)("",!0),(0,o.Uk)(" $ "+(0,e.zw)(t.$filters.currency(s.final_total))+" ",1),s.coupon?((0,o.wg)(),(0,o.iD)("div",m,"已套用優惠券")):(0,o.kq)("",!0)]),(0,o._)("td",v,[(0,o._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:z.status.loadingItem===s.id,onClick:t=>W.removeCartItem(s.id)},k,8,b)])])))),128))]),(0,o._)("tfoot",null,[(0,o._)("tr",null,[w,(0,o._)("td",C,"$ "+(0,e.zw)(t.$filters.currency(z.cart.total)),1)]),z.cart.final_total!==z.cart.total?((0,o.wg)(),(0,o.iD)("tr",f,[$,(0,o._)("td",x,"$ "+(0,e.zw)(t.$filters.currency(z.cart.final_total)),1)])):(0,o.kq)("",!0)])]),(0,o._)("div",L,[I,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>z.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[i.nr,z.coupon_code]]),(0,o._)("div",D,[(0,o._)("button",{type:"button",class:"btn coupon-btn",onClick:s[1]||(s[1]=(...t)=>W.addCouponCode&&W.addCouponCode(...t))}," 使用優惠券 ")])]),(0,o._)("div",q,[(0,o.Wm)(H,{to:"/fillin",class:"btn go-btn"},{default:(0,o.w5)((()=>[(0,o.Uk)("前往結帳")])),_:1})])])):z.isLoading?((0,o.wg)(),(0,o.iD)("div",U,M)):((0,o.wg)(),(0,o.iD)("div",P,[S,V,(0,o.Wm)(H,{to:"/products",class:"btn surf-btn"},{default:(0,o.w5)((()=>[(0,o.Uk)("現在去逛逛")])),_:1})]))])])],64)}a(7658);var j={data(){return{products:[],product:{},status:{loadingItem:""},cart:{carts:[]},coupon_code:"",isLoading:!1}},inject:["$httpMessageState","emitter"],methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/eunho-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,this.products=t.data.products})).catch((t=>{console.log(t)}))},getProduct(t){this.$router.push(`/product/${t}`)},addCart(t){const s="https://vue3-course-api.hexschool.io/api/eunho-api/cart";this.status.loadingItem=t;const a={product_id:t,qty:1};this.$http.post(s,{data:a}).then((t=>{this.status.loadingItem=""})).catch((t=>{console.log(t)}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/eunho-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,this.cart=t.data.data,this.cartLength=t.data.data.carts.length,this.emitter.emit("sendNum",{data:this.cartLength})})).catch((t=>{console.log(t)}))},updateCart(t){const s=`https://vue3-course-api.hexschool.io/api/eunho-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const a={product_id:t.product_id,qty:t.qty};this.$http.put(s,{data:a}).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.getCart()})).catch((t=>{console.log(t)}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/eunho-api/coupon",s={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:s}).then((t=>{this.isLoading=!1,this.$httpMessageState(t,"套用優惠券"),this.getCart()})).catch((t=>{console.log(t)}))},removeCartItem(t){const s=`https://vue3-course-api.hexschool.io/api/eunho-api/cart/${t}`;this.$http.delete(s).then((t=>{this.$httpMessageState(t,"移除商品"),this.status.loadingItem="",this.getCart()})).catch((t=>{console.log(t)}))}},created(){this.getProducts(),this.getCart()}},H=a(89);const Y=(0,H.Z)(j,[["render",W]]);var K=Y}}]);
//# sourceMappingURL=880.83e4a8e3.js.map