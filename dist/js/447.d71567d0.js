"use strict";(self["webpackChunkvueworks"]=self["webpackChunkvueworks"]||[]).push([[447],{2447:function(t,s,a){a.r(s),a.d(s,{default:function(){return K}});var e=a(3396),i=a(7139),o=a(9242);const n={class:"container fill-in"},l={class:"row cart"},d={key:0},c=(0,e._)("h3",null,"購物清單",-1),u={class:"table align-middle"},r=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",{class:"col-1"},"圖片"),(0,e._)("th",{class:"col-5"},"商品名稱"),(0,e._)("th",{class:"col-2"},"數量"),(0,e._)("th",null,"單價"),(0,e._)("th")])],-1),p={class:"input-group input-group-sm"},h=["disabled","onUpdate:modelValue","onChange"],g={class:"input-group-text"},_={key:0},m={key:1,class:"text-danger"},v={class:"text-end"},b=["disabled","onClick"],y=(0,e._)("i",{class:"bi bi-trash3"},null,-1),k=[y],w=(0,e._)("td",{colspan:"4",class:"text-end"},"總計",-1),C={class:"text-end"},f={key:0},$=(0,e._)("td",{colspan:"4",class:"text-end text-danger"},"折扣價",-1),x={class:"text-end text-danger"},L={class:"use-coupon input-group input-group-sm mb-3"},I=(0,e._)("div",{class:"col-7"},null,-1),D={class:"input-group-append"},q={class:"go-pay text-end"},U={key:1,class:"container spin"},z=(0,e._)("div",{class:"spinner-border text-success",role:"status"},[(0,e._)("span",{class:"visually-hidden"},"Loading...")],-1),M=[z],P={key:2,class:"nothing"},S=(0,e._)("i",{class:"bi bi-cart-dash"},null,-1),V=(0,e._)("div",{class:"nothing-content fs-3"},"哎呀，購物車目前是空的喔",-1);function W(t,s,a,y,z,W){const j=(0,e.up)("LoaDing"),H=(0,e.up)("router-link");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(j,{avtive:z.isLoading},null,8,["avtive"]),(0,e._)("div",n,[(0,e._)("div",l,[z.cart.carts.length?((0,e.wg)(),(0,e.iD)("div",d,[c,(0,e._)("table",u,[r,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(z.cart.carts,(s=>((0,e.wg)(),(0,e.iD)("tr",{key:s.id},[(0,e._)("td",{class:"list-pic",style:(0,i.j5)({backgroundImage:`url(${s.product.imageUrl})`})},null,4),(0,e._)("td",null,(0,i.zw)(s.product.title),1),(0,e._)("td",null,[(0,e._)("div",p,[(0,e.wy)((0,e._)("input",{type:"number",class:"form-control",min:"1",disabled:z.status.loadingItem===s.id,"onUpdate:modelValue":t=>s.qty=t,onChange:t=>W.updateCart(s)},null,40,h),[[o.nr,s.qty,void 0,{number:!0}]]),(0,e._)("div",g,(0,i.zw)(s.product.unit),1)])]),(0,e._)("td",null,[z.cart.final_total!==z.cart.total?((0,e.wg)(),(0,e.iD)("small",_,"折扣價")):(0,e.kq)("",!0),(0,e.Uk)(" $ "+(0,i.zw)(t.$filters.currency(s.final_total))+" ",1),s.coupon?((0,e.wg)(),(0,e.iD)("div",m,"已套用優惠券")):(0,e.kq)("",!0)]),(0,e._)("td",v,[(0,e._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:z.status.loadingItem===s.id,onClick:t=>W.removeCartItem(s.id)},k,8,b)])])))),128))]),(0,e._)("tfoot",null,[(0,e._)("tr",null,[w,(0,e._)("td",C,"$ "+(0,i.zw)(t.$filters.currency(z.cart.total)),1)]),z.cart.final_total!==z.cart.total?((0,e.wg)(),(0,e.iD)("tr",f,[$,(0,e._)("td",x,"$ "+(0,i.zw)(t.$filters.currency(z.cart.final_total)),1)])):(0,e.kq)("",!0)])]),(0,e._)("div",L,[I,(0,e.wy)((0,e._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>z.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[o.nr,z.coupon_code]]),(0,e._)("div",D,[(0,e._)("button",{type:"button",class:"btn coupon-btn",onClick:s[1]||(s[1]=(...t)=>W.addCouponCode&&W.addCouponCode(...t))}," 使用優惠券 ")])]),(0,e._)("div",q,[(0,e.Wm)(H,{to:"/fillin",class:"btn go-btn"},{default:(0,e.w5)((()=>[(0,e.Uk)("前往結帳")])),_:1})])])):z.isLoading?((0,e.wg)(),(0,e.iD)("div",U,M)):((0,e.wg)(),(0,e.iD)("div",P,[S,V,(0,e.Wm)(H,{to:"/products",class:"btn surf-btn"},{default:(0,e.w5)((()=>[(0,e.Uk)("現在去逛逛")])),_:1})]))])])],64)}a(7658);var j={data(){return{products:[],product:{},status:{loadingItem:""},cart:{carts:[]},coupon_code:"",isLoading:!1}},inject:["$httpMessageState","emitter"],methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/eunho-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,this.products=t.data.products}))},getProduct(t){this.$router.push(`/product/${t}`)},addCart(t){const s="https://vue3-course-api.hexschool.io/api/eunho-api/cart";this.status.loadingItem=t;const a={product_id:t,qty:1};this.$http.post(s,{data:a}).then((t=>{this.status.loadingItem=""}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/eunho-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,this.cart=t.data.data,this.cartLength=t.data.data.carts.length,this.emitter.emit("sendNum",{data:this.cartLength})}))},updateCart(t){const s=`https://vue3-course-api.hexschool.io/api/eunho-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const a={product_id:t.product_id,qty:t.qty};this.$http.put(s,{data:a}).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/eunho-api/coupon",s={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:s}).then((t=>{this.isLoading=!1,this.$httpMessageState(t,"套用優惠券"),this.getCart()}))},removeCartItem(t){const s=`https://vue3-course-api.hexschool.io/api/eunho-api/cart/${t}`;this.$http.delete(s).then((t=>{this.$httpMessageState(t,"移除商品"),this.status.loadingItem="",this.getCart()}))}},created(){this.getProducts(),this.getCart()}},H=a(89);const Y=(0,H.Z)(j,[["render",W]]);var K=Y}}]);
//# sourceMappingURL=447.d71567d0.js.map